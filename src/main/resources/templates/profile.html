<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title th:text="${title}">Index</title>
    <link rel="stylesheet" href="https://unpkg.com/ress@4.0.0/dist/ress.min.css">
    <link rel="stylesheet" href="/css/form.css">
</head>

<body>
    <div class="wrapper">
        <header>
            <div class="header">
                <a class="header-logo" th:href="@{/}">My Portfolio</a>
                <form action="/auth/logout" method="post">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                    <button type="submit" class="nav-btn">ログアウト</button>
                </form>
            </div>
        </header>

        <main class="pb-5 container main-content">
            <h1 class="main-title">自分紹介を編集する</h1>

            <!-- 自己紹介フォーム -->
            <form th:action="@{/auth/register}" th:object="${formModel}" method="post" novalidate
                class="form-container">
                <div class="form-group">
                    <label>自己紹介文</label>
                    <textarea class="form-control" rows="5" required th:field="*{biography}"></textarea>
                    <p>50文字以上、200文字以下で入力してください</p>
                    <div class="text-danger" th:errors="*{biography}"></div>
                </div>

                <div class="form-group thumbnail-group">
                    <label>アバター画像</label>
                    <button type="button" class="thumbnail-btn">画像ファイルを添付する</button>
                </div>

                <div class="button-wrapper">
                    <button type="submit" class="submit-btn">登録する</button>
                </div>
            </form>

            <!-- 画像アップロードフォーム -->
            <h1>画像アップロード</h1>
            <form th:action="@{/upload}" method="post" enctype="multipart/form-data">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                <input name="file" type="file" accept="image/*">
                <input type="submit" value="送信">
            </form>

            <!-- アップロード結果メッセージ -->
            <p th:if="${message}" th:text="${message}"></p>
            <p th:if="${error}" class="text-danger" th:text="${error}"></p>

            <!-- アップロードした画像の表示 -->
            <h1>アップロードした画像の表示</h1>
            <img th:if="${imageUrl}" th:src="@{${imageUrl}}" alt="uploaded avatar" style="width:300px;">
            <!-- デフォルト画像のフォールバック -->
            <img th:if="${imageUrl == null}"
                src="https://res.cloudinary.com/djklqnmen/image/upload/v1755339500/myprotfolio/defaultThumbnail_rryq3h.avif"
                alt="default avatar" style="width:300px;">
        </main>

        <!-- footer -->
        <footer>
            <div class="footer">portfolio site</div>
        </footer>
    </div>
</body>

</html>